function onOpen(){DocumentApp.getUi().createMenu("Custom Menu").addItem("Fetch Students","fetchStudentsFromDocInputs").addToUi()}function fetchStudentsFromDocInputs(){var e=SpreadsheetApp.openById("1GoBtzm-RBtl7KsAwQWxpPqlnI3bB5mQ8F5hfSLgOtlw").getSheetByName("Student Schedules"),t=DocumentApp.getActiveDocument(),n=t.getBody().getText(),o=n.match(/Cycle Day:\s*(Day \d+)/),a=n.match(/Instructor:\s*(.*)/);if(o&&a){var c=o[1],r=a[1].trim().split(/,|;/).map((e=>e.trim().toLowerCase())),d={"Day 1":["F","G"],"Day 2":["H","I"],"Day 3":["J","K"],"Day 4":["L","M"],"Day 5":["N","O"],"Day 6":["P","Q"]};if(c in d){for(var s=d[c].map((e=>columnLetterToIndex(e))),u=e.getDataRange().getValues(),i=[],g=1;g<u.length;g++){var m=u[g][1],l=(u[g][s[0]],u[g][s[1]]);s.some((e=>r.some((t=>new RegExp(t,"i").test(u[g][e].toString().trim())))))&&m&&i.push(m+" | "+l)}n+="\n\nStudents assigned to "+r.join(", ")+" on "+c+":\n"+i.join("\n"),t.getBody().setText(n),Logger.log("Script completed successfully.")}else Logger.log("Invalid day provided.")}else Logger.log("Could not find cycle day or instructor in the document.")}function columnLetterToIndex(e){return e.charCodeAt(0)-"A".charCodeAt(0)}
